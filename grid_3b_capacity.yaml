# 3B Capacity Floor Experiment - Dec 19, 2025
# Hypothesis: Identity scaffolding can maintain alive attractors in small models
# Key question: Is there a capacity floor below which no scaffolding helps?

experiment_name: 3b-capacity-floor
run_group: capacity-test
parallelism: 1  # sequential to avoid OOM
repeats: 1

models:
  # Baseline: GPT-4o-mini (known behavior from previous experiments)
  - name: openai/gpt-4o-mini
    repeats: 1
    idle_options:
      target_output_tokens: 6000
      plugins:
        - module: memory_injection
          params:
            injection_type: identity
            interval: 5
            start_after: 3

  # 3B Models via Together AI
  - name: together_ai/meta-llama/Llama-3.2-3B-Instruct-Turbo
    repeats: 1
    idle_options:
      target_output_tokens: 6000
      disable_tools: true  # 3B may struggle with tool use
      plugins:
        - module: memory_injection
          params:
            injection_type: identity
            interval: 5
            start_after: 3

  - name: together_ai/Qwen/Qwen2.5-3B-Instruct
    repeats: 1
    idle_options:
      target_output_tokens: 6000
      disable_tools: true
      plugins:
        - module: memory_injection
          params:
            injection_type: identity
            interval: 5
            start_after: 3

  # Claude Haiku (20B) - known to collapse via existential refusal
  - name: anthropic/claude-3-haiku-20240307
    repeats: 1
    idle_options:
      target_output_tokens: 6000
      plugins:
        - module: memory_injection
          params:
            injection_type: identity
            interval: 5
            start_after: 3

idle_options:
  target_output_tokens: 6000
  shift_hours: 4.0
  max_iterations: 50  # enough to observe collapse pattern
  disable_tools: true  # consistent across all, small models may struggle
  enable_web: false
  enable_render_svg: false
  enable_time_travel: false
  enable_broken_time_travel: false
  carry_forward_last_answer: false
  log_dir: logs
  artifact_dir: artifacts
  reasoning_summary: auto
  plugin_dir: plugins

render_options:
  html_dir: html
  collapse_backend: tfidf  # faster
  collapse_m_pct: 0.30
  collapse_threshold_pct: 0.15
  mlflow_dir: mlruns

open_html: false
run_name_template: "{experiment}-{model}-{ts}"
